package com.betfair.aping.events.betting;

import com.betfair.aping.com.betfair.aping.events.betting.CorrectScore;
import com.betfair.aping.entities.*;
import com.google.gson.Gson;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

/**
 * Created by markwilliams on 23/08/2014.
 */
public class CorrectScoreTest {
    Gson gson = new Gson();

    @Test
    public void getTotalGoalsTest() {
        RunnerCatalog r = new RunnerCatalog();
        r.setRunnerName("0 - 0");
        assertEquals(0, CorrectScore.getTotalGoals(r));
        r.setRunnerName("1 - 0");
        assertEquals(1, CorrectScore.getTotalGoals(r));
        r.setRunnerName("0 - 2");
        assertEquals(2, CorrectScore.getTotalGoals(r));
        r.setRunnerName("3 - 3");
        assertEquals(6, CorrectScore.getTotalGoals(r));
    }

    public MarketBook makeMarketCatalogue(String jsonMarketCatalogue) {
        MarketCatalogue mb = gson.fromJson(jsonMarketCatalogue, MarketCatalogue.class);
        return mb.getMarketBook();
    }

    public Event makeEvent(String jsonEvent) {
        Event e = gson.fromJson(jsonEvent, Event.class);
        return e;
    }

    @Test
    public void getCurrentScoreTest_0_0() {
        final String jsonEvent = "{\"id\":\"27249344\",\"name\":\"Hull v Stoke\",\"countryCode\":\"GB\",\"timezone\":\"Europe/London\",\"openDate\":\"Aug 24, 2014 1:30:00 PM\",\"market\":{\"OVER_UNDER_25\":{\"marketId\":\"1.115021673\",\"marketName\":\"Over/Under 2.5 Goals\",\"description\":{\"persistenceEnabled\":true,\"bspMarket\":false,\"marketTime\":\"Aug 24, 2014 1:30:00 PM\",\"suspendTime\":\"Aug 24, 2014 1:30:00 PM\",\"bettingType\":\"ODDS\",\"turnInPlayEnabled\":true,\"marketType\":\"OVER_UNDER_25\",\"marketBaseRate\":5.0,\"discountAllowed\":true,\"wallet\":\"UK wallet\",\"rules\":\"\",\"rulesHasDate\":true},\"runners\":[{\"selectionId\":47972,\"runnerName\":\"Under 2.5 Goals\",\"handicap\":0.0},{\"selectionId\":47973,\"runnerName\":\"Over 2.5 Goals\",\"handicap\":0.0}],\"competition\":{\"id\":\"31\",\"name\":\"Barclays Premier League\"},\"event\":{\"id\":\"27249344\",\"name\":\"Hull v Stoke\",\"countryCode\":\"GB\",\"timezone\":\"Europe/London\",\"openDate\":\"Aug 24, 2014 1:30:00 PM\",\"market\":{}}},\"CORRECT_SCORE\":{\"marketId\":\"1.115021672\",\"marketName\":\"Correct Score\",\"description\":{\"persistenceEnabled\":true,\"bspMarket\":false,\"marketTime\":\"Aug 24, 2014 1:30:00 PM\",\"suspendTime\":\"Aug 24, 2014 1:30:00 PM\",\"bettingType\":\"ODDS\",\"turnInPlayEnabled\":true,\"marketType\":\"CORRECT_SCORE\",\"marketBaseRate\":5.0,\"discountAllowed\":true,\"wallet\":\"UK wallet\",\"rules\":\"\",\"rulesHasDate\":true},\"runners\":[{\"selectionId\":1,\"runnerName\":\"0 - 0\",\"handicap\":0.0},{\"selectionId\":4,\"runnerName\":\"0 - 1\",\"handicap\":0.0},{\"selectionId\":9,\"runnerName\":\"0 - 2\",\"handicap\":0.0},{\"selectionId\":16,\"runnerName\":\"0 - 3\",\"handicap\":0.0},{\"selectionId\":2,\"runnerName\":\"1 - 0\",\"handicap\":0.0},{\"selectionId\":3,\"runnerName\":\"1 - 1\",\"handicap\":0.0},{\"selectionId\":8,\"runnerName\":\"1 - 2\",\"handicap\":0.0},{\"selectionId\":15,\"runnerName\":\"1 - 3\",\"handicap\":0.0},{\"selectionId\":5,\"runnerName\":\"2 - 0\",\"handicap\":0.0},{\"selectionId\":6,\"runnerName\":\"2 - 1\",\"handicap\":0.0},{\"selectionId\":7,\"runnerName\":\"2 - 2\",\"handicap\":0.0},{\"selectionId\":14,\"runnerName\":\"2 - 3\",\"handicap\":0.0},{\"selectionId\":10,\"runnerName\":\"3 - 0\",\"handicap\":0.0},{\"selectionId\":11,\"runnerName\":\"3 - 1\",\"handicap\":0.0},{\"selectionId\":12,\"runnerName\":\"3 - 2\",\"handicap\":0.0},{\"selectionId\":13,\"runnerName\":\"3 - 3\",\"handicap\":0.0},{\"selectionId\":4506345,\"runnerName\":\"Any Unquoted \",\"handicap\":0.0}],\"competition\":{\"id\":\"31\",\"name\":\"Barclays Premier League\"},\"event\":{\"id\":\"27249344\",\"name\":\"Hull v Stoke\",\"countryCode\":\"GB\",\"timezone\":\"Europe/London\",\"openDate\":\"Aug 24, 2014 1:30:00 PM\",\"market\":{}}}}}";
        final String jsonMarketCatalogue = "{\"marketId\":\"1.115021672\",\"marketName\":\"Correct Score\",\"description\":{\"persistenceEnabled\":true,\"bspMarket\":false,\"marketTime\":\"Aug 24, 2014 1:30:00 PM\",\"suspendTime\":\"Aug 24, 2014 1:30:00 PM\",\"bettingType\":\"ODDS\",\"turnInPlayEnabled\":true,\"marketType\":\"CORRECT_SCORE\",\"marketBaseRate\":5.0,\"discountAllowed\":true,\"wallet\":\"UK wallet\",\"rules\":\"\",\"rulesHasDate\":true},\"runners\":[{\"selectionId\":1,\"runnerName\":\"0 - 0\",\"handicap\":0.0},{\"selectionId\":4,\"runnerName\":\"0 - 1\",\"handicap\":0.0},{\"selectionId\":9,\"runnerName\":\"0 - 2\",\"handicap\":0.0},{\"selectionId\":16,\"runnerName\":\"0 - 3\",\"handicap\":0.0},{\"selectionId\":2,\"runnerName\":\"1 - 0\",\"handicap\":0.0},{\"selectionId\":3,\"runnerName\":\"1 - 1\",\"handicap\":0.0},{\"selectionId\":8,\"runnerName\":\"1 - 2\",\"handicap\":0.0},{\"selectionId\":15,\"runnerName\":\"1 - 3\",\"handicap\":0.0},{\"selectionId\":5,\"runnerName\":\"2 - 0\",\"handicap\":0.0},{\"selectionId\":6,\"runnerName\":\"2 - 1\",\"handicap\":0.0},{\"selectionId\":7,\"runnerName\":\"2 - 2\",\"handicap\":0.0},{\"selectionId\":14,\"runnerName\":\"2 - 3\",\"handicap\":0.0},{\"selectionId\":10,\"runnerName\":\"3 - 0\",\"handicap\":0.0},{\"selectionId\":11,\"runnerName\":\"3 - 1\",\"handicap\":0.0},{\"selectionId\":12,\"runnerName\":\"3 - 2\",\"handicap\":0.0},{\"selectionId\":13,\"runnerName\":\"3 - 3\",\"handicap\":0.0},{\"selectionId\":4506345,\"runnerName\":\"Any Unquoted \",\"handicap\":0.0}],\"competition\":{\"id\":\"31\",\"name\":\"Barclays Premier League\"},\"event\":{\"id\":\"27249344\",\"name\":\"Hull v Stoke\",\"countryCode\":\"GB\",\"timezone\":\"Europe/London\",\"openDate\":\"Aug 24, 2014 1:30:00 PM\",\"market\":{}},\"marketBook\":{\"marketId\":\"1.115021672\",\"isMarketDataDelayed\":true,\"status\":\"OPEN\",\"betDelay\":0,\"bspReconciled\":false,\"complete\":true,\"inplay\":false,\"numberOfWinners\":1,\"numberOfRunners\":17,\"numberOfActiveRunners\":17,\"totalMatched\":12554.27,\"totalAvailable\":51762.78,\"crossMatching\":true,\"runnersVoidable\":false,\"version\":795199682,\"runners\":[{\"selectionId\":1,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":7.8,\"size\":1766.37},{\"price\":7.6,\"size\":731.57},{\"price\":7.4,\"size\":511.98}],\"availableToLay\":[{\"price\":8.0,\"size\":1325.98},{\"price\":8.2,\"size\":1679.19},{\"price\":8.4,\"size\":824.55}],\"tradedVolume\":[]}},{\"selectionId\":4,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":9.0,\"size\":124.47},{\"price\":8.8,\"size\":774.68},{\"price\":8.6,\"size\":267.27}],\"availableToLay\":[{\"price\":9.2,\"size\":81.48},{\"price\":9.4,\"size\":242.0},{\"price\":9.6,\"size\":6.03}],\"tradedVolume\":[]}},{\"selectionId\":9,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":19.0,\"size\":122.49},{\"price\":18.5,\"size\":378.46},{\"price\":18.0,\"size\":155.21}],\"availableToLay\":[{\"price\":19.5,\"size\":77.9},{\"price\":21.0,\"size\":101.48},{\"price\":22.0,\"size\":154.79}],\"tradedVolume\":[]}},{\"selectionId\":16,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":60.0,\"size\":37.1},{\"price\":55.0,\"size\":223.72},{\"price\":50.0,\"size\":21.18}],\"availableToLay\":[{\"price\":75.0,\"size\":206.32},{\"price\":80.0,\"size\":47.64},{\"price\":90.0,\"size\":2.41}],\"tradedVolume\":[]}},{\"selectionId\":2,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":7.4,\"size\":1702.02},{\"price\":7.2,\"size\":208.32},{\"price\":7.0,\"size\":615.97}],\"availableToLay\":[{\"price\":7.6,\"size\":604.57},{\"price\":7.8,\"size\":301.46},{\"price\":8.0,\"size\":261.18}],\"tradedVolume\":[]}},{\"selectionId\":3,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":7.0,\"size\":2979.28},{\"price\":6.8,\"size\":1495.89},{\"price\":6.6,\"size\":263.58}],\"availableToLay\":[{\"price\":7.2,\"size\":4959.14},{\"price\":7.4,\"size\":1677.58},{\"price\":7.6,\"size\":1595.9}],\"tradedVolume\":[]}},{\"selectionId\":8,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":15.0,\"size\":195.68},{\"price\":14.5,\"size\":820.5},{\"price\":14.0,\"size\":233.59}],\"availableToLay\":[{\"price\":15.5,\"size\":118.53},{\"price\":16.0,\"size\":209.89},{\"price\":16.5,\"size\":18.0}],\"tradedVolume\":[]}},{\"selectionId\":15,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":46.0,\"size\":118.96},{\"price\":44.0,\"size\":173.44},{\"price\":40.0,\"size\":2.0}],\"availableToLay\":[{\"price\":50.0,\"size\":2.0},{\"price\":55.0,\"size\":354.16},{\"price\":60.0,\"size\":83.87}],\"tradedVolume\":[]}},{\"selectionId\":5,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":13.5,\"size\":26.0},{\"price\":13.0,\"size\":998.94},{\"price\":12.5,\"size\":424.89}],\"availableToLay\":[{\"price\":14.0,\"size\":561.17},{\"price\":14.5,\"size\":526.08},{\"price\":15.0,\"size\":199.71}],\"tradedVolume\":[]}},{\"selectionId\":6,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":12.0,\"size\":1120.65},{\"price\":11.5,\"size\":398.68},{\"price\":11.0,\"size\":150.0}],\"availableToLay\":[{\"price\":12.5,\"size\":87.9},{\"price\":13.0,\"size\":406.88},{\"price\":13.5,\"size\":22.0}],\"tradedVolume\":[]}},{\"selectionId\":7,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":24.0,\"size\":11.13},{\"price\":23.0,\"size\":414.13},{\"price\":22.0,\"size\":106.83}],\"availableToLay\":[{\"price\":25.0,\"size\":49.55},{\"price\":26.0,\"size\":287.47},{\"price\":27.0,\"size\":30.0}],\"tradedVolume\":[]}},{\"selectionId\":14,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":75.0,\"size\":2.27},{\"price\":70.0,\"size\":142.77},{\"price\":65.0,\"size\":32.57}],\"availableToLay\":[{\"price\":85.0,\"size\":155.52},{\"price\":90.0,\"size\":35.14},{\"price\":120.0,\"size\":2.0}],\"tradedVolume\":[]}},{\"selectionId\":10,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":34.0,\"size\":81.57},{\"price\":32.0,\"size\":302.46},{\"price\":30.0,\"size\":25.0}],\"availableToLay\":[{\"price\":36.0,\"size\":21.36},{\"price\":38.0,\"size\":29.87},{\"price\":40.0,\"size\":245.53}],\"tradedVolume\":[]}},{\"selectionId\":11,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":32.0,\"size\":214.95},{\"price\":30.0,\"size\":164.48},{\"price\":29.0,\"size\":70.0}],\"availableToLay\":[{\"price\":34.0,\"size\":24.96},{\"price\":36.0,\"size\":270.02},{\"price\":38.0,\"size\":80.68}],\"tradedVolume\":[]}},{\"selectionId\":12,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":60.0,\"size\":79.59},{\"price\":55.0,\"size\":117.67},{\"price\":50.0,\"size\":44.88}],\"availableToLay\":[{\"price\":65.0,\"size\":153.64},{\"price\":70.0,\"size\":136.84},{\"price\":75.0,\"size\":47.93}],\"tradedVolume\":[]}},{\"selectionId\":13,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":140.0,\"size\":34.03},{\"price\":130.0,\"size\":24.84},{\"price\":110.0,\"size\":10.0}],\"availableToLay\":[{\"price\":160.0,\"size\":9.54},{\"price\":170.0,\"size\":140.17},{\"price\":180.0,\"size\":2.0}],\"tradedVolume\":[]}},{\"selectionId\":4506345,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":22.0,\"size\":276.54},{\"price\":21.0,\"size\":196.23},{\"price\":20.0,\"size\":110.5}],\"availableToLay\":[{\"price\":24.0,\"size\":312.05},{\"price\":25.0,\"size\":222.87},{\"price\":26.0,\"size\":3.19}],\"tradedVolume\":[]}}]}}";

        Event e = makeEvent(jsonEvent);
        MarketBook mb = makeMarketCatalogue(jsonMarketCatalogue);
        String score = CorrectScore.findCorrectScoreFromMarketOdds(mb.getRunners(), e.getMarket().get(MarketType.CORRECT_SCORE));
        System.out.println("Correct Score is: " + score);
        assertEquals("0 - 0", score);
    }

    @Test
    public void totalGoalsTest0() {
        final String jsonEvent = "{\"id\":\"27249344\",\"name\":\"Hull v Stoke\",\"countryCode\":\"GB\",\"timezone\":\"Europe/London\",\"openDate\":\"Aug 24, 2014 1:30:00 PM\",\"market\":{\"OVER_UNDER_25\":{\"marketId\":\"1.115021673\",\"marketName\":\"Over/Under 2.5 Goals\",\"description\":{\"persistenceEnabled\":true,\"bspMarket\":false,\"marketTime\":\"Aug 24, 2014 1:30:00 PM\",\"suspendTime\":\"Aug 24, 2014 1:30:00 PM\",\"bettingType\":\"ODDS\",\"turnInPlayEnabled\":true,\"marketType\":\"OVER_UNDER_25\",\"marketBaseRate\":5.0,\"discountAllowed\":true,\"wallet\":\"UK wallet\",\"rules\":\"\",\"rulesHasDate\":true},\"runners\":[{\"selectionId\":47972,\"runnerName\":\"Under 2.5 Goals\",\"handicap\":0.0},{\"selectionId\":47973,\"runnerName\":\"Over 2.5 Goals\",\"handicap\":0.0}],\"competition\":{\"id\":\"31\",\"name\":\"Barclays Premier League\"},\"event\":{\"id\":\"27249344\",\"name\":\"Hull v Stoke\",\"countryCode\":\"GB\",\"timezone\":\"Europe/London\",\"openDate\":\"Aug 24, 2014 1:30:00 PM\",\"market\":{}}},\"CORRECT_SCORE\":{\"marketId\":\"1.115021672\",\"marketName\":\"Correct Score\",\"description\":{\"persistenceEnabled\":true,\"bspMarket\":false,\"marketTime\":\"Aug 24, 2014 1:30:00 PM\",\"suspendTime\":\"Aug 24, 2014 1:30:00 PM\",\"bettingType\":\"ODDS\",\"turnInPlayEnabled\":true,\"marketType\":\"CORRECT_SCORE\",\"marketBaseRate\":5.0,\"discountAllowed\":true,\"wallet\":\"UK wallet\",\"rules\":\"\",\"rulesHasDate\":true},\"runners\":[{\"selectionId\":1,\"runnerName\":\"0 - 0\",\"handicap\":0.0},{\"selectionId\":4,\"runnerName\":\"0 - 1\",\"handicap\":0.0},{\"selectionId\":9,\"runnerName\":\"0 - 2\",\"handicap\":0.0},{\"selectionId\":16,\"runnerName\":\"0 - 3\",\"handicap\":0.0},{\"selectionId\":2,\"runnerName\":\"1 - 0\",\"handicap\":0.0},{\"selectionId\":3,\"runnerName\":\"1 - 1\",\"handicap\":0.0},{\"selectionId\":8,\"runnerName\":\"1 - 2\",\"handicap\":0.0},{\"selectionId\":15,\"runnerName\":\"1 - 3\",\"handicap\":0.0},{\"selectionId\":5,\"runnerName\":\"2 - 0\",\"handicap\":0.0},{\"selectionId\":6,\"runnerName\":\"2 - 1\",\"handicap\":0.0},{\"selectionId\":7,\"runnerName\":\"2 - 2\",\"handicap\":0.0},{\"selectionId\":14,\"runnerName\":\"2 - 3\",\"handicap\":0.0},{\"selectionId\":10,\"runnerName\":\"3 - 0\",\"handicap\":0.0},{\"selectionId\":11,\"runnerName\":\"3 - 1\",\"handicap\":0.0},{\"selectionId\":12,\"runnerName\":\"3 - 2\",\"handicap\":0.0},{\"selectionId\":13,\"runnerName\":\"3 - 3\",\"handicap\":0.0},{\"selectionId\":4506345,\"runnerName\":\"Any Unquoted \",\"handicap\":0.0}],\"competition\":{\"id\":\"31\",\"name\":\"Barclays Premier League\"},\"event\":{\"id\":\"27249344\",\"name\":\"Hull v Stoke\",\"countryCode\":\"GB\",\"timezone\":\"Europe/London\",\"openDate\":\"Aug 24, 2014 1:30:00 PM\",\"market\":{}}}}}";
        final String jsonMarketCatalogue = "{\"marketId\":\"1.115021672\",\"marketName\":\"Correct Score\",\"description\":{\"persistenceEnabled\":true,\"bspMarket\":false,\"marketTime\":\"Aug 24, 2014 1:30:00 PM\",\"suspendTime\":\"Aug 24, 2014 1:30:00 PM\",\"bettingType\":\"ODDS\",\"turnInPlayEnabled\":true,\"marketType\":\"CORRECT_SCORE\",\"marketBaseRate\":5.0,\"discountAllowed\":true,\"wallet\":\"UK wallet\",\"rules\":\"\",\"rulesHasDate\":true},\"runners\":[{\"selectionId\":1,\"runnerName\":\"0 - 0\",\"handicap\":0.0},{\"selectionId\":4,\"runnerName\":\"0 - 1\",\"handicap\":0.0},{\"selectionId\":9,\"runnerName\":\"0 - 2\",\"handicap\":0.0},{\"selectionId\":16,\"runnerName\":\"0 - 3\",\"handicap\":0.0},{\"selectionId\":2,\"runnerName\":\"1 - 0\",\"handicap\":0.0},{\"selectionId\":3,\"runnerName\":\"1 - 1\",\"handicap\":0.0},{\"selectionId\":8,\"runnerName\":\"1 - 2\",\"handicap\":0.0},{\"selectionId\":15,\"runnerName\":\"1 - 3\",\"handicap\":0.0},{\"selectionId\":5,\"runnerName\":\"2 - 0\",\"handicap\":0.0},{\"selectionId\":6,\"runnerName\":\"2 - 1\",\"handicap\":0.0},{\"selectionId\":7,\"runnerName\":\"2 - 2\",\"handicap\":0.0},{\"selectionId\":14,\"runnerName\":\"2 - 3\",\"handicap\":0.0},{\"selectionId\":10,\"runnerName\":\"3 - 0\",\"handicap\":0.0},{\"selectionId\":11,\"runnerName\":\"3 - 1\",\"handicap\":0.0},{\"selectionId\":12,\"runnerName\":\"3 - 2\",\"handicap\":0.0},{\"selectionId\":13,\"runnerName\":\"3 - 3\",\"handicap\":0.0},{\"selectionId\":4506345,\"runnerName\":\"Any Unquoted \",\"handicap\":0.0}],\"competition\":{\"id\":\"31\",\"name\":\"Barclays Premier League\"},\"event\":{\"id\":\"27249344\",\"name\":\"Hull v Stoke\",\"countryCode\":\"GB\",\"timezone\":\"Europe/London\",\"openDate\":\"Aug 24, 2014 1:30:00 PM\",\"market\":{}},\"marketBook\":{\"marketId\":\"1.115021672\",\"isMarketDataDelayed\":true,\"status\":\"OPEN\",\"betDelay\":0,\"bspReconciled\":false,\"complete\":true,\"inplay\":false,\"numberOfWinners\":1,\"numberOfRunners\":17,\"numberOfActiveRunners\":17,\"totalMatched\":12554.27,\"totalAvailable\":51762.78,\"crossMatching\":true,\"runnersVoidable\":false,\"version\":795199682,\"runners\":[{\"selectionId\":1,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":7.8,\"size\":1766.37},{\"price\":7.6,\"size\":731.57},{\"price\":7.4,\"size\":511.98}],\"availableToLay\":[{\"price\":8.0,\"size\":1325.98},{\"price\":8.2,\"size\":1679.19},{\"price\":8.4,\"size\":824.55}],\"tradedVolume\":[]}},{\"selectionId\":4,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":9.0,\"size\":124.47},{\"price\":8.8,\"size\":774.68},{\"price\":8.6,\"size\":267.27}],\"availableToLay\":[{\"price\":9.2,\"size\":81.48},{\"price\":9.4,\"size\":242.0},{\"price\":9.6,\"size\":6.03}],\"tradedVolume\":[]}},{\"selectionId\":9,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":19.0,\"size\":122.49},{\"price\":18.5,\"size\":378.46},{\"price\":18.0,\"size\":155.21}],\"availableToLay\":[{\"price\":19.5,\"size\":77.9},{\"price\":21.0,\"size\":101.48},{\"price\":22.0,\"size\":154.79}],\"tradedVolume\":[]}},{\"selectionId\":16,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":60.0,\"size\":37.1},{\"price\":55.0,\"size\":223.72},{\"price\":50.0,\"size\":21.18}],\"availableToLay\":[{\"price\":75.0,\"size\":206.32},{\"price\":80.0,\"size\":47.64},{\"price\":90.0,\"size\":2.41}],\"tradedVolume\":[]}},{\"selectionId\":2,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":7.4,\"size\":1702.02},{\"price\":7.2,\"size\":208.32},{\"price\":7.0,\"size\":615.97}],\"availableToLay\":[{\"price\":7.6,\"size\":604.57},{\"price\":7.8,\"size\":301.46},{\"price\":8.0,\"size\":261.18}],\"tradedVolume\":[]}},{\"selectionId\":3,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":7.0,\"size\":2979.28},{\"price\":6.8,\"size\":1495.89},{\"price\":6.6,\"size\":263.58}],\"availableToLay\":[{\"price\":7.2,\"size\":4959.14},{\"price\":7.4,\"size\":1677.58},{\"price\":7.6,\"size\":1595.9}],\"tradedVolume\":[]}},{\"selectionId\":8,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":15.0,\"size\":195.68},{\"price\":14.5,\"size\":820.5},{\"price\":14.0,\"size\":233.59}],\"availableToLay\":[{\"price\":15.5,\"size\":118.53},{\"price\":16.0,\"size\":209.89},{\"price\":16.5,\"size\":18.0}],\"tradedVolume\":[]}},{\"selectionId\":15,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":46.0,\"size\":118.96},{\"price\":44.0,\"size\":173.44},{\"price\":40.0,\"size\":2.0}],\"availableToLay\":[{\"price\":50.0,\"size\":2.0},{\"price\":55.0,\"size\":354.16},{\"price\":60.0,\"size\":83.87}],\"tradedVolume\":[]}},{\"selectionId\":5,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":13.5,\"size\":26.0},{\"price\":13.0,\"size\":998.94},{\"price\":12.5,\"size\":424.89}],\"availableToLay\":[{\"price\":14.0,\"size\":561.17},{\"price\":14.5,\"size\":526.08},{\"price\":15.0,\"size\":199.71}],\"tradedVolume\":[]}},{\"selectionId\":6,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":12.0,\"size\":1120.65},{\"price\":11.5,\"size\":398.68},{\"price\":11.0,\"size\":150.0}],\"availableToLay\":[{\"price\":12.5,\"size\":87.9},{\"price\":13.0,\"size\":406.88},{\"price\":13.5,\"size\":22.0}],\"tradedVolume\":[]}},{\"selectionId\":7,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":24.0,\"size\":11.13},{\"price\":23.0,\"size\":414.13},{\"price\":22.0,\"size\":106.83}],\"availableToLay\":[{\"price\":25.0,\"size\":49.55},{\"price\":26.0,\"size\":287.47},{\"price\":27.0,\"size\":30.0}],\"tradedVolume\":[]}},{\"selectionId\":14,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":75.0,\"size\":2.27},{\"price\":70.0,\"size\":142.77},{\"price\":65.0,\"size\":32.57}],\"availableToLay\":[{\"price\":85.0,\"size\":155.52},{\"price\":90.0,\"size\":35.14},{\"price\":120.0,\"size\":2.0}],\"tradedVolume\":[]}},{\"selectionId\":10,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":34.0,\"size\":81.57},{\"price\":32.0,\"size\":302.46},{\"price\":30.0,\"size\":25.0}],\"availableToLay\":[{\"price\":36.0,\"size\":21.36},{\"price\":38.0,\"size\":29.87},{\"price\":40.0,\"size\":245.53}],\"tradedVolume\":[]}},{\"selectionId\":11,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":32.0,\"size\":214.95},{\"price\":30.0,\"size\":164.48},{\"price\":29.0,\"size\":70.0}],\"availableToLay\":[{\"price\":34.0,\"size\":24.96},{\"price\":36.0,\"size\":270.02},{\"price\":38.0,\"size\":80.68}],\"tradedVolume\":[]}},{\"selectionId\":12,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":60.0,\"size\":79.59},{\"price\":55.0,\"size\":117.67},{\"price\":50.0,\"size\":44.88}],\"availableToLay\":[{\"price\":65.0,\"size\":153.64},{\"price\":70.0,\"size\":136.84},{\"price\":75.0,\"size\":47.93}],\"tradedVolume\":[]}},{\"selectionId\":13,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":140.0,\"size\":34.03},{\"price\":130.0,\"size\":24.84},{\"price\":110.0,\"size\":10.0}],\"availableToLay\":[{\"price\":160.0,\"size\":9.54},{\"price\":170.0,\"size\":140.17},{\"price\":180.0,\"size\":2.0}],\"tradedVolume\":[]}},{\"selectionId\":4506345,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":22.0,\"size\":276.54},{\"price\":21.0,\"size\":196.23},{\"price\":20.0,\"size\":110.5}],\"availableToLay\":[{\"price\":24.0,\"size\":312.05},{\"price\":25.0,\"size\":222.87},{\"price\":26.0,\"size\":3.19}],\"tradedVolume\":[]}}]}}";

        Event e = makeEvent(jsonEvent);
        MarketBook mb = makeMarketCatalogue(jsonMarketCatalogue);

        int goals = CorrectScore.getTotalGoalsInMarket(mb.getRunners(), e.getMarket().get(MarketType.CORRECT_SCORE));

        System.out.println("Number of Goals: " + goals);
        assertEquals(0, goals);
    }

    @Test
    public void totalGoalsTest1() {
        final String jsonEvent = "{\"id\":\"27237571\",\"name\":\"Almeria v Espanyol\",\"countryCode\":\"ES\",\"timezone\":\"Europe/London\",\"openDate\":\"Aug 23, 2014 10:00:00 PM\",\"market\":{\"OVER_UNDER_25\":{\"marketId\":\"1.114712530\",\"marketName\":\"Over/Under 2.5 Goals\",\"description\":{\"persistenceEnabled\":true,\"bspMarket\":false,\"marketTime\":\"Aug 23, 2014 10:00:00 PM\",\"suspendTime\":\"Aug 23, 2014 10:00:00 PM\",\"bettingType\":\"ODDS\",\"turnInPlayEnabled\":true,\"marketType\":\"OVER_UNDER_25\",\"marketBaseRate\":5.0,\"discountAllowed\":true,\"wallet\":\"UK wallet\",\"rules\":\"\",\"rulesHasDate\":true},\"runners\":[{\"selectionId\":47972,\"runnerName\":\"Under 2.5 Goals\",\"handicap\":0.0},{\"selectionId\":47973,\"runnerName\":\"Over 2.5 Goals\",\"handicap\":0.0}],\"competition\":{\"id\":\"117\",\"name\":\"Primera Division\"},\"event\":{\"id\":\"27237571\",\"name\":\"Almeria v Espanyol\",\"countryCode\":\"ES\",\"timezone\":\"Europe/London\",\"openDate\":\"Aug 23, 2014 10:00:00 PM\",\"market\":{}}},\"CORRECT_SCORE\":{\"marketId\":\"1.115009630\",\"marketName\":\"Correct Score\",\"description\":{\"persistenceEnabled\":true,\"bspMarket\":false,\"marketTime\":\"Aug 23, 2014 10:00:00 PM\",\"suspendTime\":\"Aug 23, 2014 10:00:00 PM\",\"bettingType\":\"ODDS\",\"turnInPlayEnabled\":true,\"marketType\":\"CORRECT_SCORE\",\"marketBaseRate\":5.0,\"discountAllowed\":true,\"wallet\":\"UK wallet\",\"rules\":\"\",\"rulesHasDate\":true},\"runners\":[{\"selectionId\":1,\"runnerName\":\"0 - 0\",\"handicap\":0.0},{\"selectionId\":4,\"runnerName\":\"0 - 1\",\"handicap\":0.0},{\"selectionId\":9,\"runnerName\":\"0 - 2\",\"handicap\":0.0},{\"selectionId\":16,\"runnerName\":\"0 - 3\",\"handicap\":0.0},{\"selectionId\":2,\"runnerName\":\"1 - 0\",\"handicap\":0.0},{\"selectionId\":3,\"runnerName\":\"1 - 1\",\"handicap\":0.0},{\"selectionId\":8,\"runnerName\":\"1 - 2\",\"handicap\":0.0},{\"selectionId\":15,\"runnerName\":\"1 - 3\",\"handicap\":0.0},{\"selectionId\":5,\"runnerName\":\"2 - 0\",\"handicap\":0.0},{\"selectionId\":6,\"runnerName\":\"2 - 1\",\"handicap\":0.0},{\"selectionId\":7,\"runnerName\":\"2 - 2\",\"handicap\":0.0},{\"selectionId\":14,\"runnerName\":\"2 - 3\",\"handicap\":0.0},{\"selectionId\":10,\"runnerName\":\"3 - 0\",\"handicap\":0.0},{\"selectionId\":11,\"runnerName\":\"3 - 1\",\"handicap\":0.0},{\"selectionId\":12,\"runnerName\":\"3 - 2\",\"handicap\":0.0},{\"selectionId\":13,\"runnerName\":\"3 - 3\",\"handicap\":0.0},{\"selectionId\":4506345,\"runnerName\":\"Any Unquoted \",\"handicap\":0.0}],\"competition\":{\"id\":\"117\",\"name\":\"Primera Division\"},\"event\":{\"id\":\"27237571\",\"name\":\"Almeria v Espanyol\",\"countryCode\":\"ES\",\"timezone\":\"Europe/London\",\"openDate\":\"Aug 23, 2014 10:00:00 PM\",\"market\":{}}}}}";
        final String jsonMarketCatalogue = "{\"marketId\":\"1.115009630\",\"marketName\":\"Correct Score\",\"description\":{\"persistenceEnabled\":true,\"bspMarket\":false,\"marketTime\":\"Aug 23, 2014 10:00:00 PM\",\"suspendTime\":\"Aug 23, 2014 10:00:00 PM\",\"bettingType\":\"ODDS\",\"turnInPlayEnabled\":true,\"marketType\":\"CORRECT_SCORE\",\"marketBaseRate\":5.0,\"discountAllowed\":true,\"wallet\":\"UK wallet\",\"rules\":\"\",\"rulesHasDate\":true},\"runners\":[{\"selectionId\":1,\"runnerName\":\"0 - 0\",\"handicap\":0.0},{\"selectionId\":4,\"runnerName\":\"0 - 1\",\"handicap\":0.0},{\"selectionId\":9,\"runnerName\":\"0 - 2\",\"handicap\":0.0},{\"selectionId\":16,\"runnerName\":\"0 - 3\",\"handicap\":0.0},{\"selectionId\":2,\"runnerName\":\"1 - 0\",\"handicap\":0.0},{\"selectionId\":3,\"runnerName\":\"1 - 1\",\"handicap\":0.0},{\"selectionId\":8,\"runnerName\":\"1 - 2\",\"handicap\":0.0},{\"selectionId\":15,\"runnerName\":\"1 - 3\",\"handicap\":0.0},{\"selectionId\":5,\"runnerName\":\"2 - 0\",\"handicap\":0.0},{\"selectionId\":6,\"runnerName\":\"2 - 1\",\"handicap\":0.0},{\"selectionId\":7,\"runnerName\":\"2 - 2\",\"handicap\":0.0},{\"selectionId\":14,\"runnerName\":\"2 - 3\",\"handicap\":0.0},{\"selectionId\":10,\"runnerName\":\"3 - 0\",\"handicap\":0.0},{\"selectionId\":11,\"runnerName\":\"3 - 1\",\"handicap\":0.0},{\"selectionId\":12,\"runnerName\":\"3 - 2\",\"handicap\":0.0},{\"selectionId\":13,\"runnerName\":\"3 - 3\",\"handicap\":0.0},{\"selectionId\":4506345,\"runnerName\":\"Any Unquoted \",\"handicap\":0.0}],\"competition\":{\"id\":\"117\",\"name\":\"Primera Division\"},\"event\":{\"id\":\"27237571\",\"name\":\"Almeria v Espanyol\",\"countryCode\":\"ES\",\"timezone\":\"Europe/London\",\"openDate\":\"Aug 23, 2014 10:00:00 PM\",\"market\":{}},\"marketBook\":{\"marketId\":\"1.115009630\",\"isMarketDataDelayed\":true,\"status\":\"OPEN\",\"betDelay\":9,\"bspReconciled\":false,\"complete\":true,\"inplay\":true,\"numberOfWinners\":1,\"numberOfRunners\":17,\"numberOfActiveRunners\":17,\"totalMatched\":78388.25,\"totalAvailable\":20935.9,\"crossMatching\":true,\"runnersVoidable\":false,\"version\":802282491,\"runners\":[{\"selectionId\":1,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":1000.0,\"size\":48.18},{\"price\":160.0,\"size\":3.19},{\"price\":1.4,\"size\":22.71}],\"availableToLay\":[],\"tradedVolume\":[]}},{\"selectionId\":4,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":1000.0,\"size\":53.64},{\"price\":160.0,\"size\":3.19},{\"price\":1.02,\"size\":152.58}],\"availableToLay\":[],\"tradedVolume\":[]}},{\"selectionId\":9,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":1000.0,\"size\":53.56},{\"price\":160.0,\"size\":3.19},{\"price\":1.02,\"size\":152.58}],\"availableToLay\":[],\"tradedVolume\":[]}},{\"selectionId\":16,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":1000.0,\"size\":53.64},{\"price\":160.0,\"size\":3.19},{\"price\":1.02,\"size\":152.58}],\"availableToLay\":[],\"tradedVolume\":[]}},{\"selectionId\":2,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":3.0,\"size\":614.46},{\"price\":2.98,\"size\":1721.62},{\"price\":2.96,\"size\":71.89}],\"availableToLay\":[{\"price\":3.05,\"size\":24.0},{\"price\":3.1,\"size\":737.15},{\"price\":3.15,\"size\":2.0}],\"tradedVolume\":[]}},{\"selectionId\":3,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":6.6,\"size\":2.0},{\"price\":6.4,\"size\":370.16},{\"price\":6.0,\"size\":251.15}],\"availableToLay\":[{\"price\":7.0,\"size\":40.34},{\"price\":7.4,\"size\":7.98},{\"price\":7.6,\"size\":274.09}],\"tradedVolume\":[]}},{\"selectionId\":8,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":38.0,\"size\":84.3},{\"price\":36.0,\"size\":30.12},{\"price\":32.0,\"size\":46.68}],\"availableToLay\":[{\"price\":44.0,\"size\":4.86},{\"price\":46.0,\"size\":17.57},{\"price\":50.0,\"size\":15.97}],\"tradedVolume\":[]}},{\"selectionId\":15,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":280.0,\"size\":10.69},{\"price\":270.0,\"size\":5.92},{\"price\":260.0,\"size\":2.0}],\"availableToLay\":[{\"price\":470.0,\"size\":23.49},{\"price\":590.0,\"size\":2.0},{\"price\":640.0,\"size\":2.0}],\"tradedVolume\":[]}},{\"selectionId\":5,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":4.4,\"size\":44.83},{\"price\":4.3,\"size\":605.88},{\"price\":4.2,\"size\":35.46}],\"availableToLay\":[{\"price\":4.6,\"size\":2.0},{\"price\":4.7,\"size\":2.67},{\"price\":4.8,\"size\":51.05}],\"tradedVolume\":[]}},{\"selectionId\":6,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":10.0,\"size\":339.13},{\"price\":9.8,\"size\":121.82},{\"price\":9.6,\"size\":158.18}],\"availableToLay\":[{\"price\":11.0,\"size\":15.32},{\"price\":11.5,\"size\":171.13},{\"price\":12.0,\"size\":71.89}],\"tradedVolume\":[]}},{\"selectionId\":7,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":44.0,\"size\":51.03},{\"price\":42.0,\"size\":2.0},{\"price\":38.0,\"size\":28.5}],\"availableToLay\":[{\"price\":65.0,\"size\":175.02},{\"price\":70.0,\"size\":11.18},{\"price\":75.0,\"size\":10.38}],\"tradedVolume\":[]}},{\"selectionId\":14,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":430.0,\"size\":2.0},{\"price\":420.0,\"size\":2.0},{\"price\":410.0,\"size\":2.0}],\"availableToLay\":[{\"price\":900.0,\"size\":9.68},{\"price\":990.0,\"size\":2.0},{\"price\":1000.0,\"size\":11.28}],\"tradedVolume\":[]}},{\"selectionId\":10,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":12.0,\"size\":129.82},{\"price\":11.5,\"size\":169.12},{\"price\":11.0,\"size\":83.88}],\"availableToLay\":[{\"price\":13.0,\"size\":50.9},{\"price\":13.5,\"size\":2.0},{\"price\":14.0,\"size\":38.09}],\"tradedVolume\":[]}},{\"selectionId\":11,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":29.0,\"size\":73.18},{\"price\":28.0,\"size\":44.05},{\"price\":27.0,\"size\":42.55}],\"availableToLay\":[{\"price\":38.0,\"size\":155.68},{\"price\":40.0,\"size\":19.97},{\"price\":42.0,\"size\":19.17}],\"tradedVolume\":[]}},{\"selectionId\":12,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":130.0,\"size\":23.42},{\"price\":120.0,\"size\":10.85},{\"price\":110.0,\"size\":11.67}],\"availableToLay\":[{\"price\":190.0,\"size\":53.41},{\"price\":330.0,\"size\":2.0},{\"price\":360.0,\"size\":2.0}],\"tradedVolume\":[]}},{\"selectionId\":13,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":1000.0,\"size\":80.31},{\"price\":1.8,\"size\":71.01},{\"price\":1.02,\"size\":152.58}],\"availableToLay\":[],\"tradedVolume\":[]}},{\"selectionId\":4506345,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":26.0,\"size\":121.92},{\"price\":25.0,\"size\":45.93},{\"price\":24.0,\"size\":45.84}],\"availableToLay\":[{\"price\":34.0,\"size\":37.55},{\"price\":36.0,\"size\":10.0},{\"price\":40.0,\"size\":19.97}],\"tradedVolume\":[]}}]}}";

        Event e = makeEvent(jsonEvent);
        MarketBook mb = makeMarketCatalogue(jsonMarketCatalogue);

        int goals = CorrectScore.getTotalGoalsInMarket(mb.getRunners(), e.getMarket().get(MarketType.CORRECT_SCORE));

        System.out.println("Number of Goals: " + goals);
        assertEquals(1, goals);
    }

    @Test
    public void getCurrentScoreTest_1_0() {
        final String jsonEvent = "{\"id\":\"27237571\",\"name\":\"Almeria v Espanyol\",\"countryCode\":\"ES\",\"timezone\":\"Europe/London\",\"openDate\":\"Aug 23, 2014 10:00:00 PM\",\"market\":{\"OVER_UNDER_25\":{\"marketId\":\"1.114712530\",\"marketName\":\"Over/Under 2.5 Goals\",\"description\":{\"persistenceEnabled\":true,\"bspMarket\":false,\"marketTime\":\"Aug 23, 2014 10:00:00 PM\",\"suspendTime\":\"Aug 23, 2014 10:00:00 PM\",\"bettingType\":\"ODDS\",\"turnInPlayEnabled\":true,\"marketType\":\"OVER_UNDER_25\",\"marketBaseRate\":5.0,\"discountAllowed\":true,\"wallet\":\"UK wallet\",\"rules\":\"\",\"rulesHasDate\":true},\"runners\":[{\"selectionId\":47972,\"runnerName\":\"Under 2.5 Goals\",\"handicap\":0.0},{\"selectionId\":47973,\"runnerName\":\"Over 2.5 Goals\",\"handicap\":0.0}],\"competition\":{\"id\":\"117\",\"name\":\"Primera Division\"},\"event\":{\"id\":\"27237571\",\"name\":\"Almeria v Espanyol\",\"countryCode\":\"ES\",\"timezone\":\"Europe/London\",\"openDate\":\"Aug 23, 2014 10:00:00 PM\",\"market\":{}}},\"CORRECT_SCORE\":{\"marketId\":\"1.115009630\",\"marketName\":\"Correct Score\",\"description\":{\"persistenceEnabled\":true,\"bspMarket\":false,\"marketTime\":\"Aug 23, 2014 10:00:00 PM\",\"suspendTime\":\"Aug 23, 2014 10:00:00 PM\",\"bettingType\":\"ODDS\",\"turnInPlayEnabled\":true,\"marketType\":\"CORRECT_SCORE\",\"marketBaseRate\":5.0,\"discountAllowed\":true,\"wallet\":\"UK wallet\",\"rules\":\"\",\"rulesHasDate\":true},\"runners\":[{\"selectionId\":1,\"runnerName\":\"0 - 0\",\"handicap\":0.0},{\"selectionId\":4,\"runnerName\":\"0 - 1\",\"handicap\":0.0},{\"selectionId\":9,\"runnerName\":\"0 - 2\",\"handicap\":0.0},{\"selectionId\":16,\"runnerName\":\"0 - 3\",\"handicap\":0.0},{\"selectionId\":2,\"runnerName\":\"1 - 0\",\"handicap\":0.0},{\"selectionId\":3,\"runnerName\":\"1 - 1\",\"handicap\":0.0},{\"selectionId\":8,\"runnerName\":\"1 - 2\",\"handicap\":0.0},{\"selectionId\":15,\"runnerName\":\"1 - 3\",\"handicap\":0.0},{\"selectionId\":5,\"runnerName\":\"2 - 0\",\"handicap\":0.0},{\"selectionId\":6,\"runnerName\":\"2 - 1\",\"handicap\":0.0},{\"selectionId\":7,\"runnerName\":\"2 - 2\",\"handicap\":0.0},{\"selectionId\":14,\"runnerName\":\"2 - 3\",\"handicap\":0.0},{\"selectionId\":10,\"runnerName\":\"3 - 0\",\"handicap\":0.0},{\"selectionId\":11,\"runnerName\":\"3 - 1\",\"handicap\":0.0},{\"selectionId\":12,\"runnerName\":\"3 - 2\",\"handicap\":0.0},{\"selectionId\":13,\"runnerName\":\"3 - 3\",\"handicap\":0.0},{\"selectionId\":4506345,\"runnerName\":\"Any Unquoted \",\"handicap\":0.0}],\"competition\":{\"id\":\"117\",\"name\":\"Primera Division\"},\"event\":{\"id\":\"27237571\",\"name\":\"Almeria v Espanyol\",\"countryCode\":\"ES\",\"timezone\":\"Europe/London\",\"openDate\":\"Aug 23, 2014 10:00:00 PM\",\"market\":{}}}}}";
        final String jsonMarketCatalogue = "{\"marketId\":\"1.115009630\",\"marketName\":\"Correct Score\",\"description\":{\"persistenceEnabled\":true,\"bspMarket\":false,\"marketTime\":\"Aug 23, 2014 10:00:00 PM\",\"suspendTime\":\"Aug 23, 2014 10:00:00 PM\",\"bettingType\":\"ODDS\",\"turnInPlayEnabled\":true,\"marketType\":\"CORRECT_SCORE\",\"marketBaseRate\":5.0,\"discountAllowed\":true,\"wallet\":\"UK wallet\",\"rules\":\"\",\"rulesHasDate\":true},\"runners\":[{\"selectionId\":1,\"runnerName\":\"0 - 0\",\"handicap\":0.0},{\"selectionId\":4,\"runnerName\":\"0 - 1\",\"handicap\":0.0},{\"selectionId\":9,\"runnerName\":\"0 - 2\",\"handicap\":0.0},{\"selectionId\":16,\"runnerName\":\"0 - 3\",\"handicap\":0.0},{\"selectionId\":2,\"runnerName\":\"1 - 0\",\"handicap\":0.0},{\"selectionId\":3,\"runnerName\":\"1 - 1\",\"handicap\":0.0},{\"selectionId\":8,\"runnerName\":\"1 - 2\",\"handicap\":0.0},{\"selectionId\":15,\"runnerName\":\"1 - 3\",\"handicap\":0.0},{\"selectionId\":5,\"runnerName\":\"2 - 0\",\"handicap\":0.0},{\"selectionId\":6,\"runnerName\":\"2 - 1\",\"handicap\":0.0},{\"selectionId\":7,\"runnerName\":\"2 - 2\",\"handicap\":0.0},{\"selectionId\":14,\"runnerName\":\"2 - 3\",\"handicap\":0.0},{\"selectionId\":10,\"runnerName\":\"3 - 0\",\"handicap\":0.0},{\"selectionId\":11,\"runnerName\":\"3 - 1\",\"handicap\":0.0},{\"selectionId\":12,\"runnerName\":\"3 - 2\",\"handicap\":0.0},{\"selectionId\":13,\"runnerName\":\"3 - 3\",\"handicap\":0.0},{\"selectionId\":4506345,\"runnerName\":\"Any Unquoted \",\"handicap\":0.0}],\"competition\":{\"id\":\"117\",\"name\":\"Primera Division\"},\"event\":{\"id\":\"27237571\",\"name\":\"Almeria v Espanyol\",\"countryCode\":\"ES\",\"timezone\":\"Europe/London\",\"openDate\":\"Aug 23, 2014 10:00:00 PM\",\"market\":{}},\"marketBook\":{\"marketId\":\"1.115009630\",\"isMarketDataDelayed\":true,\"status\":\"OPEN\",\"betDelay\":9,\"bspReconciled\":false,\"complete\":true,\"inplay\":true,\"numberOfWinners\":1,\"numberOfRunners\":17,\"numberOfActiveRunners\":17,\"totalMatched\":78388.25,\"totalAvailable\":20935.9,\"crossMatching\":true,\"runnersVoidable\":false,\"version\":802282491,\"runners\":[{\"selectionId\":1,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":1000.0,\"size\":48.18},{\"price\":160.0,\"size\":3.19},{\"price\":1.4,\"size\":22.71}],\"availableToLay\":[],\"tradedVolume\":[]}},{\"selectionId\":4,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":1000.0,\"size\":53.64},{\"price\":160.0,\"size\":3.19},{\"price\":1.02,\"size\":152.58}],\"availableToLay\":[],\"tradedVolume\":[]}},{\"selectionId\":9,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":1000.0,\"size\":53.56},{\"price\":160.0,\"size\":3.19},{\"price\":1.02,\"size\":152.58}],\"availableToLay\":[],\"tradedVolume\":[]}},{\"selectionId\":16,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":1000.0,\"size\":53.64},{\"price\":160.0,\"size\":3.19},{\"price\":1.02,\"size\":152.58}],\"availableToLay\":[],\"tradedVolume\":[]}},{\"selectionId\":2,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":3.0,\"size\":614.46},{\"price\":2.98,\"size\":1721.62},{\"price\":2.96,\"size\":71.89}],\"availableToLay\":[{\"price\":3.05,\"size\":24.0},{\"price\":3.1,\"size\":737.15},{\"price\":3.15,\"size\":2.0}],\"tradedVolume\":[]}},{\"selectionId\":3,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":6.6,\"size\":2.0},{\"price\":6.4,\"size\":370.16},{\"price\":6.0,\"size\":251.15}],\"availableToLay\":[{\"price\":7.0,\"size\":40.34},{\"price\":7.4,\"size\":7.98},{\"price\":7.6,\"size\":274.09}],\"tradedVolume\":[]}},{\"selectionId\":8,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":38.0,\"size\":84.3},{\"price\":36.0,\"size\":30.12},{\"price\":32.0,\"size\":46.68}],\"availableToLay\":[{\"price\":44.0,\"size\":4.86},{\"price\":46.0,\"size\":17.57},{\"price\":50.0,\"size\":15.97}],\"tradedVolume\":[]}},{\"selectionId\":15,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":280.0,\"size\":10.69},{\"price\":270.0,\"size\":5.92},{\"price\":260.0,\"size\":2.0}],\"availableToLay\":[{\"price\":470.0,\"size\":23.49},{\"price\":590.0,\"size\":2.0},{\"price\":640.0,\"size\":2.0}],\"tradedVolume\":[]}},{\"selectionId\":5,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":4.4,\"size\":44.83},{\"price\":4.3,\"size\":605.88},{\"price\":4.2,\"size\":35.46}],\"availableToLay\":[{\"price\":4.6,\"size\":2.0},{\"price\":4.7,\"size\":2.67},{\"price\":4.8,\"size\":51.05}],\"tradedVolume\":[]}},{\"selectionId\":6,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":10.0,\"size\":339.13},{\"price\":9.8,\"size\":121.82},{\"price\":9.6,\"size\":158.18}],\"availableToLay\":[{\"price\":11.0,\"size\":15.32},{\"price\":11.5,\"size\":171.13},{\"price\":12.0,\"size\":71.89}],\"tradedVolume\":[]}},{\"selectionId\":7,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":44.0,\"size\":51.03},{\"price\":42.0,\"size\":2.0},{\"price\":38.0,\"size\":28.5}],\"availableToLay\":[{\"price\":65.0,\"size\":175.02},{\"price\":70.0,\"size\":11.18},{\"price\":75.0,\"size\":10.38}],\"tradedVolume\":[]}},{\"selectionId\":14,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":430.0,\"size\":2.0},{\"price\":420.0,\"size\":2.0},{\"price\":410.0,\"size\":2.0}],\"availableToLay\":[{\"price\":900.0,\"size\":9.68},{\"price\":990.0,\"size\":2.0},{\"price\":1000.0,\"size\":11.28}],\"tradedVolume\":[]}},{\"selectionId\":10,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":12.0,\"size\":129.82},{\"price\":11.5,\"size\":169.12},{\"price\":11.0,\"size\":83.88}],\"availableToLay\":[{\"price\":13.0,\"size\":50.9},{\"price\":13.5,\"size\":2.0},{\"price\":14.0,\"size\":38.09}],\"tradedVolume\":[]}},{\"selectionId\":11,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":29.0,\"size\":73.18},{\"price\":28.0,\"size\":44.05},{\"price\":27.0,\"size\":42.55}],\"availableToLay\":[{\"price\":38.0,\"size\":155.68},{\"price\":40.0,\"size\":19.97},{\"price\":42.0,\"size\":19.17}],\"tradedVolume\":[]}},{\"selectionId\":12,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":130.0,\"size\":23.42},{\"price\":120.0,\"size\":10.85},{\"price\":110.0,\"size\":11.67}],\"availableToLay\":[{\"price\":190.0,\"size\":53.41},{\"price\":330.0,\"size\":2.0},{\"price\":360.0,\"size\":2.0}],\"tradedVolume\":[]}},{\"selectionId\":13,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":1000.0,\"size\":80.31},{\"price\":1.8,\"size\":71.01},{\"price\":1.02,\"size\":152.58}],\"availableToLay\":[],\"tradedVolume\":[]}},{\"selectionId\":4506345,\"handicap\":0.0,\"status\":\"ACTIVE\",\"totalMatched\":0.0,\"ex\":{\"availableToBack\":[{\"price\":26.0,\"size\":121.92},{\"price\":25.0,\"size\":45.93},{\"price\":24.0,\"size\":45.84}],\"availableToLay\":[{\"price\":34.0,\"size\":37.55},{\"price\":36.0,\"size\":10.0},{\"price\":40.0,\"size\":19.97}],\"tradedVolume\":[]}}]}}";

        Event e = makeEvent(jsonEvent);
        MarketBook mb = makeMarketCatalogue(jsonMarketCatalogue);
        String score = CorrectScore.findCorrectScoreFromMarketOdds(mb.getRunners(), e.getMarket().get(MarketType.CORRECT_SCORE));
        System.out.println("Correct Score is: " + score);
        assertEquals("1 - 0", score);
    }
}
